"use strict";(self.webpackChunk_kne_components_components_ckeditor=self.webpackChunk_kne_components_components_ckeditor||[]).push([[291,986],{720:(e,t,o)=>{o.d(t,{A:()=>l});var n={};o.r(n),o.d(n,{default:()=>a,getFileUrl:()=>i});var s=o(3647),r=o(3050);const i=JSON.parse('{"code":0,"error_msg":"success","data":{}}'),a={locale:"en-US",apis:{file:{getUrl:{loader:()=>i.data},upload:e=>{let{file:t}=e;return{}},staticUrl:"/"}}},l={name:"Editor",summary:"<p>\u5bcc\u6587\u672c\u7f16\u8f91\u5668ckeditor\u7684\u5c01\u88c5</p>",api:"<table>\n<thead>\n<tr>\n<th>\u5c5e\u6027\u540d</th>\n<th>\u8bf4\u660e</th>\n<th>\u7c7b\u578b</th>\n<th>\u9ed8\u8ba4\u503c</th>\n</tr>\n</thead>\n</table>",example:{isFull:!0,className:"Editor_344a7",style:"",list:[{title:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u6807\u9898",description:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u8bf4\u660e",code:"const {default: Editor} = _Editor;\nconst {useState} = React;\nconst {createWithRemoteLoader} = remoteLoader;\nconst {default: preset} = _mockPreset;\nconst BaseExample = createWithRemoteLoader({\n    modules: ['components-core:Global@PureGlobal']\n})(({remoteModules}) => {\n    const [PureGlobal] = remoteModules;\n    const [value, onChange] = useState(\"<p>\u8bf7\u8f93\u5165\u5185\u5bb9</p>\");\n    return <PureGlobal preset={preset}>\n        <Editor.Field value={value} onChange={onChange}/>\n        <div>\u9884\u89c8\uff1a</div>\n        <Editor.Content value={value}/>\n    </PureGlobal>;\n});\n\nrender(<BaseExample/>);\n\n",scope:[{name:"_Editor",packageName:"@components/Editor",component:s},{name:"remoteLoader",packageName:"@kne/remote-loader",component:r},{name:"_mockPreset",packageName:"@root/mockPreset",component:n}]},{title:"\u5728\u8868\u5355\u4e2d\u4f7f\u7528",description:"\u5728\u8868\u5355\u4e2d\u4f7f\u7528",code:'const {default: CKEditor} = _Editor;\nconst {createWithRemoteLoader} = remoteLoader;\nconst {default: preset} = _mockPreset;\nconst BaseExample = createWithRemoteLoader({\n    modules: [\'components-core:Global@PureGlobal\', "components-core:FormInfo", "components-core:FormInfo@formModule"],\n})(({remoteModules}) => {\n    const [PureGlobal, FormInfo, formModule] = remoteModules;\n    const {Form, SubmitButton} = formModule;\n    return (\n        <PureGlobal preset={preset}>\n            <Form\n                data={{\n                    des: \'\u5bcc\u6587\u672c\u5185\u5bb9\',\n                }}\n                onSubmit={(data) => {\n                    console.log(data);\n                }}\n            >\n                <FormInfo\n                    title="\u5728\u8868\u5355\u4e2d\u4f7f\u7528"\n                    column={1}\n                    list={[<CKEditor label="\u5bcc\u6587\u672c" name="des"/>]}\n                    rule="REQ"\n                />\n                <SubmitButton type="primary" block>\n                    \u63d0\u4ea4\n                </SubmitButton>\n            </Form>\n        </PureGlobal>\n    );\n});\n\nrender(<BaseExample/>);\n\n',scope:[{name:"_Editor",packageName:"@components/Editor",component:s},{name:"remoteLoader",packageName:"@kne/remote-loader",component:r},{name:"_mockPreset",packageName:"@root/mockPreset",component:n}]}]}}},3373:(e,t,o)=>{o.d(t,{A:()=>n});const n={name:"ComponentBox",summary:"<p>\u6dfb\u52a0\u4e00\u4e2ahtml\u7ec4\u4ef6\u5230\u5bcc\u6587\u672c\u7f16\u8f91\u5668</p>",api:"<table>\n<thead>\n<tr>\n<th>\u5c5e\u6027\u540d</th>\n<th>\u8bf4\u660e</th>\n<th>\u7c7b\u578b</th>\n<th>\u9ed8\u8ba4\u503c</th>\n</tr>\n</thead>\n</table>",example:{isFull:!1,className:"ComponentBox_492c9",style:"",list:[{title:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u6807\u9898",description:"\u8fd9\u91cc\u586b\u5199\u793a\u4f8b\u8bf4\u660e",code:"const { default: Editor } = _Editor;\nconst { default: componentBoxLoader } = _ComponentBox;\nconst BaseExample = () => {\n  return (\n    <Editor.Field\n      pluginLoaders={[componentBoxLoader]}\n      config={{\n        toolbar: {\n          items: ['componentBox']\n        },\n        componentBox: {\n          list: [\n            {\n              type: 'Example1',\n              name: '\u793a\u4f8b1',\n              defaultProps: {\n                test: '111111'\n              },\n              render: (dom, props) => {\n                dom.innerHTML = '<span>\u54c8\u54c8\u54c8\u54c8</span>';\n              }\n            },\n            {\n              type: 'Example2',\n              name: '\u793a\u4f8b2',\n              render: (dom, props) => {\n                dom.innerHTML = '<span>\u54c8\u54c8\u54c8\u54c82222222</span>';\n              }\n            }\n          ]\n        }\n      }}\n    />\n  );\n};\n\nrender(<BaseExample />);\n\n",scope:[{name:"_Editor",packageName:"@components/Editor",component:o(3647)},{name:"_ComponentBox",packageName:"@components/ComponentBox",component:o(7986)}]}]}}},3647:(e,t,o)=>{o.r(t),o.d(t,{default:()=>y});var n=o(3884);const s="style_editor__sRX1d__n7VRw",r="style_word-count__8OS-O__n7VRw",i="style_surplus-count__1Ml-M__n7VRw",a="style_error__0sOJZ__n7VRw";var l=o(3050),c=o(7558),d=o.n(c);const m={loading:null,loader:async e=>{let{params:t}=e;const o=(null===t||void 0===t?void 0:t.locale)||"zh-cn";return await(0,l.getOrLoadRemote)("ClassicEditor","",(0,l.getPublicPath)("components-ckeditor")+`/ckeditor/${"zh-cn"===o?"zh-cn":"en"}/ckeditor.js`),{CKEditor:window.ClassicEditor}}};(0,c.createWithFetch)(m);var p=o(252),u=o(4156),h=o.n(u),g=o(8529),w=o.n(g),v=o(2399),b=o(5199),x=o(5534),_=o.n(x),f=o(3446);const B={wordCount:{displayWords:!1},toolbar:{items:["undo","redo","|","heading","style","|","bold","italic","underline","strikethrough","link","bulletedList","numberedList","todoList","fontBackgroundColor","fontColor","fontSize","|","alignment","pageBreak","outdent","indent","|","specialCharacters","subscript","superscript","|","imageUpload","blockQuote","insertTable","highlight","horizontalLine","|","selectAll","removeFormat"]},list:{properties:{styles:!0,startIndex:!0,reversed:!0}},style:{definitions:[{name:"Headings",element:"h2",classes:["primary-part-title"]},{name:"Subheadings",element:"h3",classes:["part-title"]},{name:"Paragraph",element:"p",classes:["part-content"]},{name:"Card",element:"p",classes:["card"]},{name:"Primary Card",element:"p",classes:["primary-card"]},{name:"Keywords",element:"span",classes:["key-word"]}]}},C=e=>{let{locale:t,config:o,pluginLoaders:n=[],...s}=e;const{message:r}=b.App.useApp();return(0,f.jsx)(d(),{...Object.assign({},m,{params:{locale:t}}),render:e=>{let{data:t}=e;const{CKEditor:i}=t,a=n.map((e=>e(i.libs)));return(0,f.jsx)(p.CKEditor,{...s,editor:i,config:_()({},{message:r},B,o,{extraPlugins:[v.default,...a]})})}})},k=(0,l.createWithRemoteLoader)({modules:["components-core:Global@usePreset"]})((e=>{var t,o;let{remoteModules:l,...c}=e;const[d]=l,{apis:m,locale:p}=d(),{className:u,config:g,pluginLoaders:v,data:x,maxLength:B,wordCount:k,ossUpload:E,...y}=Object.assign({},{maxLength:5e3,pluginLoaders:[],wordCount:!1},c),[P,V]=w()(y),[T,S]=(0,n.useState)(0),{message:F}=b.App.useApp();return(0,f.jsxs)("div",{className:h()(u,s),children:[(0,f.jsx)(C,{locale:p,onReady:e=>{const t=e.plugins.get("WordCount");S(t.characters)},data:P,onChange:(e,t)=>{const o=t.plugins.get("WordCount");if(B&&o.characters>B)return F.error("\u8f93\u5165\u5185\u5bb9\u8d85\u8fc7\u6700\u5927\u5b57\u7b26\u9650\u5236"),void t.setData(P);S(o.characters);const n=t.getData();V(n)},config:_()({ossUpload:{upload:null===m||void 0===m||null===(t=m.file)||void 0===t?void 0:t.upload,uploadUrl:null===m||void 0===m||null===(o=m.file)||void 0===o?void 0:o.uploadUrl}},g,{ossUpload:E})}),k&&(0,f.jsxs)("div",{className:r,children:[(0,f.jsxs)("div",{children:["\u5f53\u524d\u5b57\u7b26:",T]}),(0,f.jsxs)("div",{className:h()(i,B&&{[a]:B-T<50}),children:["\u5269\u4f59\u5b57\u7b26:",B-T]})]})]})})),E=(0,l.createWithRemoteLoader)({modules:["components-core:FormInfo@hooks"]})((e=>{let{remoteModules:t,...o}=e;const[n]=t,{useDecorator:s}=n;return s(Object.assign({},o))(k)}));E.Field=k,E.Content=e=>{let{className:t,children:o}=e;return(0,f.jsx)("div",{className:h()("ck ck-content",t),dangerouslySetInnerHTML:{__html:o}})},E.defaultEditorConfig=B;const y=E},4037:(e,t,o)=>{o.d(t,{A:()=>n});o(3884);const n=o.p+"static/media/img_fail.92f698baf5c5ad60bf4437eb46f9525a.svg"},7986:(e,t,o)=>{o.r(t),o.d(t,{default:()=>a});const n=e=>{let{core:t,widget:o}=e;const{Command:n,Plugin:s}=t,{toWidget:r,Widget:i}=o;class a extends n{execute(e){let{type:t,props:o}=e;this.editor.model.change((e=>{this.editor.model.insertContent(e.createElement("componentBox",{"data-type":t,"data-props":o}))}))}refresh(){const e=this.editor.model,t=e.document.selection,o=e.schema.findAllowedParent(t.getFirstPosition(),"componentBox");this.isEnabled=null!==o}}return class extends s{static get requires(){return[i]}init(){this._defineSchema(),this._defineConverters(),this.editor.commands.add("insertComponentBox",new a(this.editor))}_defineSchema(){this.editor.model.schema.register("componentBox",{inheritAllFrom:"$blockObject",allowAttributes:["data-type","data-props"]})}_defineConverters(){var e;const t=this.editor,o=t.conversion,n=(null===(e=t.config.get("componentBox"))||void 0===e?void 0:e.list)||[];o.for("upcast").elementToElement({model:(e,t)=>{let{writer:o}=t;const n=e.getAttribute("data-props"),s=e.getAttribute("data-type");return o.createElement("componentBox",{"data-type":s,"data-props":n})},view:{name:"section",classes:"component-box"}});const s=(e,t)=>{let{writer:o}=t;const s=e.getAttribute("data-type"),r=e.getAttribute("data-props"),i=o.createContainerElement("section",{class:"component-box","data-type":s,"data-props":JSON.stringify(r)}),a=o.createRawElement("div",{class:"component-box-wrapper"},(e=>{var t,o;null===(t=n.find((e=>e.type===s)))||void 0===t||null===(o=t.render)||void 0===o||o.call(t,e,r)}));return o.insert(o.createPositionAt(i,0),a),i};o.for("dataDowncast").elementToElement({model:"componentBox",view:(e,t)=>{let{writer:o}=t;return s(e,{writer:o})}}),o.for("editingDowncast").elementToElement({model:"componentBox",view:(e,t)=>{let{writer:o}=t;const n=s(e,{writer:o});return r(n,o,{label:"component box widget",hasSelectionHandle:!0})}})}}},s=e=>{let{core:t,ui:o}=e;const{Plugin:n}=t,{addToolbarToDropdown:s,ButtonView:r,createDropdown:i,View:a}=o;class l extends a{constructor(e,t){super(e),this.children=t,this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-grid"],role:"listbox"},children:this.children})}}return class extends n{init(){var e;const t=this.editor,o=t.t,n=(null===(e=t.config.get("componentBox"))||void 0===e?void 0:e.list)||[];0!==n.length&&t.ui.componentFactory.add("componentBox",(e=>{const a=i(e);a.buttonView.set({withText:!1,label:o("ComponentBox"),icon:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1696642601020" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10458" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M384 480h-128c-52.8 0-96-43.2-96-96v-128c0-52.8 43.2-96 96-96h128c52.8 0 96 43.2 96 96v128c0 52.8-43.2 96-96 96z m-128-256c-17.6 0-32 14.4-32 32v128c0 17.6 14.4 32 32 32h128c17.6 0 32-14.4 32-32v-128c0-17.6-14.4-32-32-32h-128zM768 480h-128c-52.8 0-96-43.2-96-96v-128c0-52.8 43.2-96 96-96h128c52.8 0 96 43.2 96 96v128c0 52.8-43.2 96-96 96z m-128-256c-17.6 0-32 14.4-32 32v128c0 17.6 14.4 32 32 32h128c17.6 0 32-14.4 32-32v-128c0-17.6-14.4-32-32-32h-128zM384 864h-128c-52.8 0-96-43.2-96-96v-128c0-52.8 43.2-96 96-96h128c52.8 0 96 43.2 96 96v128c0 52.8-43.2 96-96 96z m-128-256c-17.6 0-32 14.4-32 32v128c0 17.6 14.4 32 32 32h128c17.6 0 32-14.4 32-32v-128c0-17.6-14.4-32-32-32h-128zM768 864h-128c-52.8 0-96-43.2-96-96v-128c0-52.8 43.2-96 96-96h128c52.8 0 96 43.2 96 96v128c0 52.8-43.2 96-96 96z m-128-256c-17.6 0-32 14.4-32 32v128c0 17.6 14.4 32 32 32h128c17.6 0 32-14.4 32-32v-128c0-17.6-14.4-32-32-32h-128z" p-id="10459"></path></svg>',tooltip:!0});const c=new l(e,n.map((o=>{let{type:n,name:s,defaultProps:i}=o;const a=new r(e);return a.set({label:s,withText:!0,tooltip:!0}),this.listenTo(a,"execute",(()=>t.execute("insertComponentBox",{type:n,props:i||{}}))),a})));return s(a,[c]),a}))}}},r=e=>{let{core:t}=e;const{Plugin:o}=t;return class extends o{constructor(){super(...arguments),this.getClosestSelectedWidget=e=>{const t=this.editor.editing.mapper;if(!e.getFirstPosition())return null;const o=e.getSelectedElement();return o&&"componentBox"===t.toModelElement(o).name?o:null}}static get pluginName(){return"ComponentBoxUtil"}}},i=e=>{let{core:t,ui:o,widget:n}=e;const{icons:s,Plugin:i}=t,{BalloonPanelView:a,ButtonView:l,ContextualBalloon:c,createLabeledInputText:d,CssTransitionDisablerMixin:m,LabeledFieldView:p,LabelView:u,submitHandler:h,View:g}=o,{WidgetToolbarRepository:w}=n,v=r({core:t,ui:o,widget:n});function b(e){const t=e.editing.view,o=a.defaultPositions,n=e.plugins.get("ComponentBoxUtil");return{target:t.domConverter.mapViewToDom(n.getClosestSelectedWidget(t.document.selection)),positions:[o.northArrowSouth,o.northArrowSouthWest,o.northArrowSouthEast,o.southArrowNorth,o.southArrowNorthWest,o.southArrowNorthEast,o.viewportStickyNorth]}}class x extends g{constructor(e){super(e),this.abbrInputView=this._createInput("Add abbreviation"),this.titleInputView=this._createInput("Add title"),this.saveButtonView=this._createButton("Save",s.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton("Cancel",s.cancel,"ck-button-cancel");const t=new u(e);t.text="\u7ec4\u4ef6\u5c5e\u6027",this.childViews=this.createCollection([t,this.abbrInputView,this.titleInputView,this.saveButtonView,this.cancelButtonView]),this.setTemplate({tag:"form",attributes:{class:["ck","ck-abbr-form"],tabindex:"-1"},children:this.childViews})}render(){super.render(),h({view:this})}focus(){this.childViews.first.focus()}_createInput(e){const t=new p(this.locale,d);return t.label=e,t}_createButton(e,t,o){const n=new l;return n.set({label:e,icon:t,tooltip:!0,class:o}),n}}class _ extends i{static get requires(){return[x,c,v]}static get pluginName(){return"ComponentBoxToolbarUI"}get _isVisible(){return!!this._balloon&&this._balloon.visibleView===this._form}get _isInBalloon(){return!!this._balloon&&this._balloon.hasView(this._form)}destroy(){super.destroy(),this._form&&this._form.destroy()}_createButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("componentBoxProps",(o=>{e.commands.get("componentBoxProps");const n=new l(o);return n.set({label:t("\u5c5e\u6027\u8bbe\u7f6e"),icon:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1696668156648" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5490" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M323.333 653.333c-16.8 0-30 13.2-30 30s13.2 30 30 30c16.8 0 30-13.2 30-30 0-16.8-13.2-30-30-30zM323.333 293.333c-16.8 0-30 13.2-30 30s13.2 30 30 30c16.8 0 30-13.2 30-30 0-16.8-13.2-30-30-30zM323.333 473.333c-16.8 0-30 13.2-30 30s13.2 30 30 30c16.8 0 30-13.2 30-30 0-16.8-13.2-30-30-30zM773.333 113.333h-540c-66 0-120 54-120 120v540c0 66 54 120 120 120h540c66 0 120-54 120-120v-540c0-66-54-120-120-120zM833.333 773.333c0 33-27 60-60 60h-540c-33 0-60-27-60-60v-540c0-33 27-60 60-60h540c33 0 60 27 60 60v540zM683.333 293.333h-240c-16.8 0-30 13.2-30 30s13.2 30 30 30h240c16.8 0 30-13.2 30-30s-13.2-30-30-30zM683.333 473.333h-240c-16.8 0-30 13.2-30 30s13.2 30 30 30h240c16.8 0 30-13.2 30-30s-13.2-30-30-30zM683.333 653.333h-240c-16.8 0-30 13.2-30 30s13.2 30 30 30h240c16.8 0 30-13.2 30-30s-13.2-30-30-30z" fill="#272636" p-id="5491"></path></svg>',tooltip:!0}),this.listenTo(n,"execute",(()=>{this._showForm()})),n}))}_createForm(){const e=this.editor,t=e.editing.view,o=t.document,n=e.plugins.get("ComponentBoxUtil");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(m(x))(e.locale),this._form.render(),this.listenTo(this._form,"submit",(()=>{this._hideForm(!0)})),this.listenTo(this._form,"cancel",(()=>{this._hideForm(!0)})),console.log(t.keystrokes),this.listenTo(e.ui,"update",(()=>{n.getClosestSelectedWidget(o.selection)?this._isVisible&&function(e){const t=e.plugins.get("ContextualBalloon");if(e.plugins.get("ComponentBoxUtil").getClosestSelectedWidget(e.editing.view.document.selection)){const o=b(e);t.updatePosition(o)}}(e):this._hideForm(!0)}))}_showForm(){if(this._isVisible)return;this._form||this._createForm();const e=this.editor;var t;(this._form.disableCssTransitions(),this._isInBalloon)||(null===(t=this._balloon)||void 0===t||t.add({view:this._form,position:b(e)}));this._form.enableCssTransitions()}_hideForm(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}init(){this._createButton()}}return class extends i{static get pluginName(){return"ComponentBoxToolbar"}static get requires(){return[_,v]}afterInit(){const e=this.editor,t=e.plugins.get("ComponentBoxUtil");e.plugins.get(w).register("componentBox",{items:["componentBoxProps"],getRelatedElement:t.getClosestSelectedWidget})}}},a=e=>{const{core:t}=e,{Plugin:o}=t,r=s(e),a=n(e),l=i(e);return class extends o{static get pluginName(){return"ComponentBox"}static get requires(){return[r,a,l]}}}}}]);
//# sourceMappingURL=291.4ae2ce97.chunk.js.map