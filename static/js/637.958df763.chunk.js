"use strict";(self.webpackChunk_kne_components_components_ckeditor=self.webpackChunk_kne_components_components_ckeditor||[]).push([[637],{2399:(e,t,o)=>{o.r(t),o.d(t,{default:()=>n});var a=o(4037);class s{constructor(e,t){this.loader=e,this.options=t}async upload(){const e=await this.loader.file;if("function"!==typeof this.options.upload){console.warn("\u5f53\u524d\u56fe\u7247\u4e0a\u4f20\u4e3abase64\u6a21\u5f0f\uff0c\u6b63\u5f0f\u73af\u5883\u8bf7\u5728preset apis\u8bbe\u7f6efile.upload,\u6216\u8005\u7ed9CKEditor\u7ec4\u4ef6\u4f20\u5165 config.ossUpload.upload\u53c2\u6570");return{default:await new Promise((t=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.readAsDataURL(e)}))}}const{code:t,data:o,msg:s}=await this.options.upload({file:e});return 0!==t?(this.options.message.error(s),{default:a.A}):{default:o}}}const n=function(e){const t=e.config.get("message"),o=Object.assign({},{message:t},e.config.get("ossUpload"));e.plugins.get("FileRepository").createUploadAdapter=e=>new s(e,o),e.editing.view.document.on("clipboardInput",((s,n)=>{if(e.isReadOnly)return;const r=n.dataTransfer.getData("text/html"),i=(new DOMParser).parseFromString(r,"text/html");if(0===i.querySelectorAll("img").length)return;n.content=e.data.htmlProcessor.toView("");const l=t.loading("\u7c98\u8d34\u5185\u5bb9\u4e2d\u542b\u6709\u56fe\u7247\uff0c\u6b63\u5728\u8fdb\u884c\u56fe\u7247\u4e0a\u4f20...",{duration:0});Promise.all([].slice.call(i.querySelectorAll("img"),0).map((async e=>{if("function"!==typeof o.uploadUrl)return void console.warn("\u56fe\u7247\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u5728preset apis\u8bbe\u7f6efile.uploadUrl,\u6216\u8005\u7ed9CKEditor\u7ec4\u4ef6\u4f20\u5165 config.ossUpload.uploadUrl\u53c2\u6570");const{code:t,data:s,msg:n}=await o.uploadUrl({url:e.src});if(0!==t)return console.warn(`\u56fe\u7247\u4e0a\u4f20\u5931\u8d25\uff0c${n}`),void(e.src=a.A);e.src=s}))).then((()=>{e.model.insertContent(e.data.toModel(e.data.htmlProcessor.toView(i.documentElement.outerHTML)))})).finally((()=>{l()}))}))}},4037:(e,t,o)=>{o.d(t,{A:()=>a});o(3884);const a=o.p+"static/media/img_fail.92f698baf5c5ad60bf4437eb46f9525a.svg"}}]);
//# sourceMappingURL=637.958df763.chunk.js.map