"use strict";(self.webpackChunk_kne_components_components_ckeditor=self.webpackChunk_kne_components_components_ckeditor||[]).push([[737],{50737:(t,e,o)=>{o.r(e),o.d(e,{default:()=>s});o(73884);const n=o.p+"static/media/img_fail.92f698baf5c5ad60bf4437eb46f9525a.svg";class a{constructor(t,e){this.loader=t,this.options=e}async upload(){const t=await this.loader.file;if("function"!==typeof this.options.upload){return{default:await new Promise((e=>{const o=new FileReader;o.onload=()=>{e(o.result)},o.readAsDataURL(t)}))}}const{code:e,data:o,msg:a}=await this.options.upload({file:t});return 0!==e?(this.options.message.error(a),{default:n}):{default:o}}}const s=function(t){const e=t.config.get("message"),o=Object.assign({},{message:e},t.config.get("ossUpload"));t.plugins.get("FileRepository").createUploadAdapter=t=>new a(t,o),t.editing.view.document.on("clipboardInput",((a,s)=>{if(t.isReadOnly)return;const r=s.dataTransfer.getData("text/html"),i=(new DOMParser).parseFromString(r,"text/html");if(0===i.querySelectorAll("img").length)return;s.content=t.data.htmlProcessor.toView("");const c=e.loading("\u7c98\u8d34\u5185\u5bb9\u4e2d\u542b\u6709\u56fe\u7247\uff0c\u6b63\u5728\u8fdb\u884c\u56fe\u7247\u4e0a\u4f20...",{duration:0});Promise.all([].slice.call(i.querySelectorAll("img"),0).map((async t=>{if("function"!==typeof o.transform)return;const{code:e,data:a,msg:s}=await o.transform({url:t.src});if(0!==e)return console.warn("\u56fe\u7247\u4e0a\u4f20\u5931\u8d25\uff0c".concat(s)),void(t.src=n);t.src=a}))).then((()=>{t.model.insertContent(t.data.toModel(t.data.htmlProcessor.toView(i.documentElement.outerHTML)))})).finally((()=>{c()}))}))}}}]);
//# sourceMappingURL=737.39a8ec9e.chunk.js.map