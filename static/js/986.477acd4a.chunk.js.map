{"version":3,"file":"static/js/986.477acd4a.chunk.js","mappings":"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","sources":["components/ComponentBox/componentBoxEditingLoader.js","components/ComponentBox/componentBoxUILoader.js","components/ComponentBox/icon.raw.svg","components/ComponentBox/componentBoxUtilLoader.js","components/ComponentBox/componentBoxToolbarLoader.js","components/ComponentBox/props-icon.raw.svg","components/ComponentBox/index.js"],"sourcesContent":["const componentBoxEditingLoader = ({ core, widget }) => {\n  const { Command, Plugin } = core;\n  const { toWidget, Widget } = widget;\n\n  class InsertProductPreviewCommand extends Command {\n    execute({ type, props }) {\n      this.editor.model.change(writer => {\n        this.editor.model.insertContent(\n          writer.createElement('componentBox', {\n            'data-type': type,\n            'data-props': props\n          })\n        );\n      });\n    }\n\n    refresh() {\n      const model = this.editor.model;\n      const selection = model.document.selection;\n      const allowedIn = model.schema.findAllowedParent(selection.getFirstPosition(), 'componentBox');\n\n      this.isEnabled = allowedIn !== null;\n    }\n  }\n\n  class ComponentBoxEditing extends Plugin {\n    static get requires() {\n      return [Widget];\n    }\n\n    init() {\n      this._defineSchema();\n      this._defineConverters();\n\n      this.editor.commands.add('insertComponentBox', new InsertProductPreviewCommand(this.editor));\n    }\n\n    _defineSchema() {\n      const schema = this.editor.model.schema;\n\n      schema.register('componentBox', {\n        inheritAllFrom: '$blockObject',\n        allowAttributes: ['data-type', 'data-props']\n      });\n    }\n\n    _defineConverters() {\n      const editor = this.editor;\n      const conversion = editor.conversion;\n      const componentBoxList = editor.config.get('componentBox')?.list || [];\n\n      conversion.for('upcast').elementToElement({\n        model: (viewElement, { writer }) => {\n          const props = viewElement.getAttribute('data-props'),\n            type = viewElement.getAttribute('data-type');\n          return writer.createElement('componentBox', {\n            'data-type': type,\n            'data-props': props\n          });\n        },\n        view: {\n          name: 'section',\n          classes: 'component-box'\n        }\n      });\n\n      const createSection = (modelElement, { writer }) => {\n        const type = modelElement.getAttribute('data-type'),\n          props = modelElement.getAttribute('data-props');\n        const section = writer.createContainerElement('section', {\n          class: 'component-box',\n          'data-type': type,\n          'data-props': JSON.stringify(props)\n        });\n\n        const componentWrapper = writer.createRawElement(\n          'div',\n          {\n            class: 'component-box-wrapper'\n          },\n          element => {\n            componentBoxList.find(item => item.type === type)?.['render']?.(element, props);\n          }\n        );\n\n        writer.insert(writer.createPositionAt(section, 0), componentWrapper);\n        return section;\n      };\n\n      conversion.for('dataDowncast').elementToElement({\n        model: 'componentBox',\n        view: (modelElement, { writer }) => createSection(modelElement, { writer })\n      });\n\n      conversion.for('editingDowncast').elementToElement({\n        model: 'componentBox',\n        view: (modelElement, { writer }) => {\n          const section = createSection(modelElement, { writer });\n          return toWidget(section, writer, { label: 'component box widget', hasSelectionHandle: true });\n        }\n      });\n    }\n  }\n\n  return ComponentBoxEditing;\n};\n\nexport default componentBoxEditingLoader;\n","import icon from './icon.raw.svg';\nconst componentBoxUILoader = ({ core, ui }) => {\n  const { Plugin } = core;\n  const { addToolbarToDropdown, ButtonView, createDropdown, View } = ui;\n  class PanelView extends View {\n    constructor(locale, children) {\n      super(locale);\n      this.children = children;\n      this.setTemplate({\n        tag: 'div',\n        attributes: {\n          class: ['ck', 'ck-style-grid'],\n          role: 'listbox'\n        },\n\n        children: this.children\n      });\n    }\n  }\n\n  class ComponentBoxUI extends Plugin {\n    init() {\n      const editor = this.editor;\n      const t = editor.t;\n      const componentBoxList = editor.config.get('componentBox')?.list || [];\n      if (componentBoxList.length === 0) {\n        return;\n      }\n      editor.ui.componentFactory.add('componentBox', local => {\n        const enabledDropdown = createDropdown(local);\n        enabledDropdown.buttonView.set({\n          withText: false,\n          label: t('ComponentBox'),\n          icon,\n          tooltip: true\n        });\n        const panelView = new PanelView(\n          local,\n          componentBoxList.map(({ type, name, defaultProps }) => {\n            const buttonView = new ButtonView(local);\n            buttonView.set({\n              label: name,\n              withText: true,\n              tooltip: true\n            });\n            this.listenTo(buttonView, 'execute', () => {\n              return editor.execute('insertComponentBox', { type, props: defaultProps || {} });\n            });\n            return buttonView;\n          })\n        );\n        addToolbarToDropdown(enabledDropdown, [panelView]);\n        return enabledDropdown;\n      });\n    }\n  }\n\n  return ComponentBoxUI;\n};\n\nexport default componentBoxUILoader;\n","export default \"<?xml version=\\\"1.0\\\" standalone=\\\"no\\\"?><!DOCTYPE svg PUBLIC \\\"-//W3C//DTD SVG 1.1//EN\\\" \\\"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\\\"><svg t=\\\"1696642601020\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"10458\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"200\\\" height=\\\"200\\\"><path d=\\\"M384 480h-128c-52.8 0-96-43.2-96-96v-128c0-52.8 43.2-96 96-96h128c52.8 0 96 43.2 96 96v128c0 52.8-43.2 96-96 96z m-128-256c-17.6 0-32 14.4-32 32v128c0 17.6 14.4 32 32 32h128c17.6 0 32-14.4 32-32v-128c0-17.6-14.4-32-32-32h-128zM768 480h-128c-52.8 0-96-43.2-96-96v-128c0-52.8 43.2-96 96-96h128c52.8 0 96 43.2 96 96v128c0 52.8-43.2 96-96 96z m-128-256c-17.6 0-32 14.4-32 32v128c0 17.6 14.4 32 32 32h128c17.6 0 32-14.4 32-32v-128c0-17.6-14.4-32-32-32h-128zM384 864h-128c-52.8 0-96-43.2-96-96v-128c0-52.8 43.2-96 96-96h128c52.8 0 96 43.2 96 96v128c0 52.8-43.2 96-96 96z m-128-256c-17.6 0-32 14.4-32 32v128c0 17.6 14.4 32 32 32h128c17.6 0 32-14.4 32-32v-128c0-17.6-14.4-32-32-32h-128zM768 864h-128c-52.8 0-96-43.2-96-96v-128c0-52.8 43.2-96 96-96h128c52.8 0 96 43.2 96 96v128c0 52.8-43.2 96-96 96z m-128-256c-17.6 0-32 14.4-32 32v128c0 17.6 14.4 32 32 32h128c17.6 0 32-14.4 32-32v-128c0-17.6-14.4-32-32-32h-128z\\\" p-id=\\\"10459\\\"></path></svg>\";","const componentBoxUtilLoader = ({ core }) => {\n  const { Plugin } = core;\n  return class ComponentBoxUtil extends Plugin {\n    static get pluginName() {\n      return 'ComponentBoxUtil';\n    }\n\n    getClosestSelectedWidget = selection => {\n      const editor = this.editor;\n      const mapper = editor.editing.mapper;\n      const selectionPosition = selection.getFirstPosition();\n\n      if (!selectionPosition) {\n        return null;\n      }\n\n      const viewElement = selection.getSelectedElement();\n\n      if (viewElement && mapper.toModelElement(viewElement).name === 'componentBox') {\n        return viewElement;\n      }\n\n      return null;\n    };\n  };\n};\n\nexport default componentBoxUtilLoader;\n","import propsIcon from './props-icon.raw.svg';\nimport componentBoxUtilLoader from './componentBoxUtilLoader';\n\nconst componentBoxToolbarLoader = ({ core, ui, widget }) => {\n  const { icons, Plugin } = core;\n  const { BalloonPanelView, ButtonView, ContextualBalloon, createLabeledInputText, CssTransitionDisablerMixin, LabeledFieldView, LabelView, submitHandler, View } = ui;\n  const { WidgetToolbarRepository } = widget;\n  const ComponentBoxUtil = componentBoxUtilLoader({ core, ui, widget });\n\n  function getBalloonPositionData(editor) {\n    const editingView = editor.editing.view;\n    const defaultPositions = BalloonPanelView.defaultPositions;\n    const componentBoxUtil = editor.plugins.get('ComponentBoxUtil');\n\n    return {\n      target: editingView.domConverter.mapViewToDom(componentBoxUtil.getClosestSelectedWidget(editingView.document.selection)),\n      positions: [\n        defaultPositions.northArrowSouth,\n        defaultPositions.northArrowSouthWest,\n        defaultPositions.northArrowSouthEast,\n        defaultPositions.southArrowNorth,\n        defaultPositions.southArrowNorthWest,\n        defaultPositions.southArrowNorthEast,\n        defaultPositions.viewportStickyNorth\n      ]\n    };\n  }\n\n  function repositionContextualBalloon(editor) {\n    const balloon = editor.plugins.get('ContextualBalloon');\n    const componentBoxUtil = editor.plugins.get('ComponentBoxUtil');\n\n    if (componentBoxUtil.getClosestSelectedWidget(editor.editing.view.document.selection)) {\n      const position = getBalloonPositionData(editor);\n      balloon.updatePosition(position);\n    }\n  }\n\n  class ComponentBoxToolbarForm extends View {\n    constructor(locale) {\n      // Previously created elements.\n      // ...\n      super(locale);\n\n      this.abbrInputView = this._createInput('Add abbreviation');\n      this.titleInputView = this._createInput('Add title');\n\n      this.saveButtonView = this._createButton('Save', icons.check, 'ck-button-save');\n      this.saveButtonView.type = 'submit';\n\n      this.cancelButtonView = this._createButton('Cancel', icons.cancel, 'ck-button-cancel');\n\n      const label = new LabelView(locale);\n      label.text = '组件属性';\n      this.childViews = this.createCollection([label, this.abbrInputView, this.titleInputView, this.saveButtonView, this.cancelButtonView]);\n\n      this.setTemplate({\n        tag: 'form',\n        attributes: {\n          class: ['ck', 'ck-abbr-form'],\n          tabindex: '-1'\n        },\n        children: this.childViews // ADDED\n      });\n\n      /*this.listenTo(this, 'submit', () => {\n               // console.log('xxxxxx', this.abbrInputView.fieldView.value, this.titleInputView.fieldView.value);\n\n                // this.editor.editing.view.focus();\n            })*/\n    }\n\n    render() {\n      super.render();\n      submitHandler({\n        view: this\n      });\n    }\n\n    focus() {\n      this.childViews.first.focus();\n    }\n\n    _createInput(label) {\n      const labeledInput = new LabeledFieldView(this.locale, createLabeledInputText);\n\n      labeledInput.label = label;\n\n      return labeledInput;\n    }\n\n    _createButton(label, icon, className) {\n      const button = new ButtonView();\n\n      button.set({\n        label,\n        icon,\n        tooltip: true,\n        class: className\n      });\n\n      return button;\n    }\n  }\n\n  class ComponentBoxToolbarUI extends Plugin {\n    static get requires() {\n      return [ComponentBoxToolbarForm, ContextualBalloon, ComponentBoxUtil];\n    }\n\n    static get pluginName() {\n      return 'ComponentBoxToolbarUI';\n    }\n\n    get _isVisible() {\n      return !!this._balloon && this._balloon.visibleView === this._form;\n    }\n\n    get _isInBalloon() {\n      return !!this._balloon && this._balloon.hasView(this._form);\n    }\n\n    destroy() {\n      super.destroy();\n      if (this._form) {\n        this._form.destroy();\n      }\n    }\n\n    _createButton() {\n      const editor = this.editor;\n      const t = editor.t;\n\n      editor.ui.componentFactory.add('componentBoxProps', locale => {\n        const command = editor.commands.get('componentBoxProps');\n        const view = new ButtonView(locale);\n\n        view.set({\n          label: t('属性设置'),\n          icon: propsIcon,\n          tooltip: true\n        });\n\n        //view.bind('isEnabled').to(command, 'isEnabled');\n        //view.bind('isOn').to(command, 'value', value => !!value);\n\n        this.listenTo(view, 'execute', () => {\n          this._showForm();\n        });\n\n        return view;\n      });\n    }\n\n    _createForm() {\n      const editor = this.editor;\n      const view = editor.editing.view;\n      const viewDocument = view.document;\n      const componentBoxUtil = editor.plugins.get('ComponentBoxUtil');\n      this._balloon = this.editor.plugins.get('ContextualBalloon');\n      this._form = new (CssTransitionDisablerMixin(ComponentBoxToolbarForm))(editor.locale);\n\n      this._form.render();\n\n      this.listenTo(this._form, 'submit', () => {\n        this._hideForm(true);\n      });\n\n      this.listenTo(this._form, 'cancel', () => {\n        this._hideForm(true);\n      });\n\n      console.log(view.keystrokes);\n\n      /*this._form.keystrokes.set('Esc', (data, cancel) => {\n                this._hideForm(true);\n                cancel();\n            });*/\n\n      this.listenTo(editor.ui, 'update', () => {\n        if (!componentBoxUtil.getClosestSelectedWidget(viewDocument.selection)) {\n          this._hideForm(true);\n        } else if (this._isVisible) {\n          repositionContextualBalloon(editor);\n        }\n      });\n    }\n\n    _showForm() {\n      if (this._isVisible) {\n        return;\n      }\n\n      if (!this._form) {\n        this._createForm();\n      }\n\n      const editor = this.editor;\n      //const command = editor.commands.get('imageTextAlternative');\n      //const labeledInput = this._form?.labeledInput;\n\n      this._form.disableCssTransitions();\n\n      if (!this._isInBalloon) {\n        this._balloon?.add({\n          view: this._form,\n          position: getBalloonPositionData(editor)\n        });\n      }\n\n      // Make sure that each time the panel shows up, the field remains in sync with the value of\n      // the command. If the user typed in the input, then canceled the balloon (`labeledInput#value`\n      // stays unaltered) and re-opened it without changing the value of the command, they would see the\n      // old value instead of the actual value of the command.\n      // https://github.com/ckeditor/ckeditor5-image/issues/114\n      //labeledInput.fieldView.value = labeledInput.fieldView.element!.value = command.value || '';\n\n      //this._form.labeledInput.fieldView.select();\n\n      this._form.enableCssTransitions();\n    }\n\n    _hideForm(focusEditable = false) {\n      if (!this._isInBalloon) {\n        return;\n      }\n\n      if (this._form.focusTracker.isFocused) {\n        this._form.saveButtonView.focus();\n      }\n\n      this._balloon.remove(this._form);\n\n      if (focusEditable) {\n        this.editor.editing.view.focus();\n      }\n    }\n\n    init() {\n      this._createButton();\n    }\n  }\n\n  class ComponentBoxToolbar extends Plugin {\n    static get pluginName() {\n      return 'ComponentBoxToolbar';\n    }\n\n    static get requires() {\n      return [ComponentBoxToolbarUI, ComponentBoxUtil];\n    }\n\n    afterInit() {\n      const editor = this.editor;\n      const componentBoxUtil = editor.plugins.get('ComponentBoxUtil');\n      const widgetToolbarRepository = editor.plugins.get(WidgetToolbarRepository);\n      widgetToolbarRepository.register('componentBox', {\n        items: ['componentBoxProps'],\n        getRelatedElement: componentBoxUtil.getClosestSelectedWidget\n      });\n    }\n  }\n\n  return ComponentBoxToolbar;\n};\n\nexport default componentBoxToolbarLoader;\n","export default \"<?xml version=\\\"1.0\\\" standalone=\\\"no\\\"?><!DOCTYPE svg PUBLIC \\\"-//W3C//DTD SVG 1.1//EN\\\" \\\"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\\\"><svg t=\\\"1696668156648\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"5490\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"200\\\" height=\\\"200\\\"><path d=\\\"M323.333 653.333c-16.8 0-30 13.2-30 30s13.2 30 30 30c16.8 0 30-13.2 30-30 0-16.8-13.2-30-30-30zM323.333 293.333c-16.8 0-30 13.2-30 30s13.2 30 30 30c16.8 0 30-13.2 30-30 0-16.8-13.2-30-30-30zM323.333 473.333c-16.8 0-30 13.2-30 30s13.2 30 30 30c16.8 0 30-13.2 30-30 0-16.8-13.2-30-30-30zM773.333 113.333h-540c-66 0-120 54-120 120v540c0 66 54 120 120 120h540c66 0 120-54 120-120v-540c0-66-54-120-120-120zM833.333 773.333c0 33-27 60-60 60h-540c-33 0-60-27-60-60v-540c0-33 27-60 60-60h540c33 0 60 27 60 60v540zM683.333 293.333h-240c-16.8 0-30 13.2-30 30s13.2 30 30 30h240c16.8 0 30-13.2 30-30s-13.2-30-30-30zM683.333 473.333h-240c-16.8 0-30 13.2-30 30s13.2 30 30 30h240c16.8 0 30-13.2 30-30s-13.2-30-30-30zM683.333 653.333h-240c-16.8 0-30 13.2-30 30s13.2 30 30 30h240c16.8 0 30-13.2 30-30s-13.2-30-30-30z\\\" fill=\\\"#272636\\\" p-id=\\\"5491\\\"></path></svg>\";","import componentBoxEditingLoader from './componentBoxEditingLoader';\nimport componentBoxUILoader from './componentBoxUILoader';\nimport componentBoxToolbarLoader from './componentBoxToolbarLoader';\n\nconst componentBoxLoader = libs => {\n  const { core } = libs;\n  const { Plugin } = core;\n  const ComponentBoxUI = componentBoxUILoader(libs),\n    ComponentBoxEditing = componentBoxEditingLoader(libs),\n    ComponentBoxToolbar = componentBoxToolbarLoader(libs);\n  return class ComponentBox extends Plugin {\n    static get pluginName() {\n      return 'ComponentBox';\n    }\n\n    static get requires() {\n      return [ComponentBoxUI, ComponentBoxEditing, ComponentBoxToolbar];\n    }\n  };\n};\n\nexport default componentBoxLoader;\n"],"names":["_ref","core","widget","Command","Plugin","toWidget","Widget","InsertProductPreviewCommand","execute","_ref2","type","props","this","editor","model","change","writer","insertContent","createElement","refresh","selection","document","allowedIn","schema","findAllowedParent","getFirstPosition","isEnabled","requires","init","_defineSchema","_defineConverters","commands","add","register","inheritAllFrom","allowAttributes","_editor$config$get","conversion","componentBoxList","config","get","list","for","elementToElement","viewElement","_ref3","getAttribute","view","name","classes","createSection","modelElement","_ref4","section","createContainerElement","class","JSON","stringify","componentWrapper","createRawElement","element","_componentBoxList$fin","_componentBoxList$fin2","find","item","call","insert","createPositionAt","_ref5","_ref6","label","hasSelectionHandle","ui","addToolbarToDropdown","ButtonView","createDropdown","View","PanelView","constructor","locale","children","super","setTemplate","tag","attributes","role","t","length","componentFactory","local","enabledDropdown","buttonView","set","withText","icon","tooltip","panelView","map","defaultProps","listenTo","arguments","getClosestSelectedWidget","mapper","editing","getSelectedElement","toModelElement","pluginName","icons","BalloonPanelView","ContextualBalloon","createLabeledInputText","CssTransitionDisablerMixin","LabeledFieldView","LabelView","submitHandler","WidgetToolbarRepository","ComponentBoxUtil","componentBoxUtilLoader","getBalloonPositionData","editingView","defaultPositions","componentBoxUtil","plugins","target","domConverter","mapViewToDom","positions","northArrowSouth","northArrowSouthWest","northArrowSouthEast","southArrowNorth","southArrowNorthWest","southArrowNorthEast","viewportStickyNorth","ComponentBoxToolbarForm","abbrInputView","_createInput","titleInputView","saveButtonView","_createButton","check","cancelButtonView","cancel","text","childViews","createCollection","tabindex","render","focus","first","labeledInput","className","button","ComponentBoxToolbarUI","_isVisible","_balloon","visibleView","_form","_isInBalloon","hasView","destroy","_showForm","_createForm","viewDocument","_hideForm","console","log","keystrokes","balloon","position","updatePosition","repositionContextualBalloon","_this$_balloon","disableCssTransitions","enableCssTransitions","focusEditable","undefined","focusTracker","isFocused","remove","afterInit","items","getRelatedElement","libs","ComponentBoxUI","componentBoxUILoader","ComponentBoxEditing","componentBoxEditingLoader","ComponentBoxToolbar","componentBoxToolbarLoader"],"sourceRoot":""}