"use strict";(self.webpackChunk_kne_components_components_ckeditor=self.webpackChunk_kne_components_components_ckeditor||[]).push([[616],{5235:(t,e,o)=>{o.r(e),o.d(e,{default:()=>n});o(73884);const s=o.p+"static/media/img_fail.92f698baf5c5ad60bf4437eb46f9525a.svg";class a{constructor(t,e){this.loader=t,this.options=e}async upload(){const t=await this.loader.file;if("function"!==typeof this.options.upload){console.warn("\u5f53\u524d\u56fe\u7247\u4e0a\u4f20\u4e3abase64\u6a21\u5f0f\uff0c\u6b63\u5f0f\u73af\u5883\u8bf7\u5728preset apis\u8bbe\u7f6eossStaticUpload,\u6216\u8005\u7ed9CKEditor\u7ec4\u4ef6\u4f20\u5165 config.ossUpload.upload\u53c2\u6570");return{default:await new Promise((e=>{const o=new FileReader;o.onload=()=>{e(o.result)},o.readAsDataURL(t)}))}}const{code:e,data:o,msg:a}=await this.options.upload({file:t});return 0!==e?(this.options.message.error(a),{default:s}):{default:o}}}const n=function(t){const e=t.config.get("message"),o=Object.assign({},{message:e},t.config.get("ossUpload"));t.plugins.get("FileRepository").createUploadAdapter=t=>new a(t,o),t.editing.view.document.on("clipboardInput",((a,n)=>{if(t.isReadOnly)return;const r=n.dataTransfer.getData("text/html"),i=(new DOMParser).parseFromString(r,"text/html");if(0===i.querySelectorAll("img").length)return;n.content=t.data.htmlProcessor.toView("");const c=e.loading("\u7c98\u8d34\u5185\u5bb9\u4e2d\u542b\u6709\u56fe\u7247\uff0c\u6b63\u5728\u8fdb\u884c\u56fe\u7247\u4e0a\u4f20...",{duration:0});Promise.all([].slice.call(i.querySelectorAll("img"),0).map((async t=>{if("function"!==typeof o.transform)return void console.warn("\u56fe\u7247\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u5728preset apis\u8bbe\u7f6eossStaticTransform,\u6216\u8005\u7ed9CKEditor\u7ec4\u4ef6\u4f20\u5165 config.ossUpload.transform\u53c2\u6570");const{code:e,data:a,msg:n}=await o.transform({url:t.src});if(0!==e)return console.warn("\u56fe\u7247\u4e0a\u4f20\u5931\u8d25\uff0c".concat(n)),void(t.src=s);t.src=a}))).then((()=>{t.model.insertContent(t.data.toModel(t.data.htmlProcessor.toView(i.documentElement.outerHTML)))})).finally((()=>{c()}))}))}}}]);
//# sourceMappingURL=616.31593f18.chunk.js.map