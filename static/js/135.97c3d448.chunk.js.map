{"version":3,"file":"static/js/135.97c3d448.chunk.js","mappings":"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","sources":["preset.js","App.js","bootstrap.js","components/OssUploadAdapterPlugin/index.js","../node_modules/@babel/standalone|sync"],"sourcesContent":["import React from 'react';\nimport {preset as fetchPreset} from '@kne/react-fetch';\nimport {Spin, Empty} from 'antd';\nimport axios from 'axios';\nimport {preset as remoteLoaderPreset} from '@kne/remote-loader';\n\nwindow.PUBLIC_URL = process.env.PUBLIC_URL;\n\nconst componentsCoreRemote = {\n    remote: \"components-core\",\n    url: \"https://registry.npmmirror.com\",\n    tpl: \"{{url}}/@kne-components%2f{{remote}}/{{version}}/files/build\",\n    defaultVersion: '0.3.3',\n};\n\nremoteLoaderPreset({\n    remotes: {\n        default: componentsCoreRemote,\n        'components-core': componentsCoreRemote,\n        'components-iconfont':{\n            remote: \"components-iconfont\",\n            url: \"https://registry.npmmirror.com\",\n            tpl: \"{{url}}/@kne-components%2f{{remote}}/{{version}}/files/build\",\n            defaultVersion: '0.1.3',\n        },\n        'components-ckeditor': process.env.NODE_ENV === 'development' ? {\n            remote: 'components-ckeditor', url: '/', tpl: '{{url}}'\n        } : {\n            remote: 'components-ckeditor',\n            url: 'https://registry.npmmirror.com',\n            tpl: '{{url}}/@kne-components%2f{{remote}}/{{version}}/files/build',\n            defaultVersion: process.env.DEFAULT_VERSION\n        }\n    }\n});\n\nexport const ajax = axios.create({\n    validateStatus: function () {\n        return true;\n    }\n});\n\n\nfetchPreset({\n    ajax,\n    loading: <Spin delay={500}\n                   style={{position: 'absolute', left: '50%', padding: '10px', transform: 'translateX(-50%)'}}/>,\n    error: null,\n    empty: <Empty/>,\n    transformResponse: (response) => {\n        const {data} = response;\n        response.data = {\n            code: data.code === 0 ? 200 : data.code, msg: data.msg, results: data.data\n        };\n        return response;\n    }\n});\n","import { HashRouter } from \"react-router-dom\";\nimport createEntry from \"@kne/modules-dev/dist/create-entry\";\nimport \"@kne/modules-dev/dist/create-entry.css\";\nimport readme from \"readme\";\n\nconst ExampleRoutes = createEntry.ExampleRoutes;\n\nconst App = ({ preset, themeToken, ...props }) => {\n  return (\n      <HashRouter>\n        <ExampleRoutes\n            {...props}\n            paths={[\n              {\n                key: \"components\",\n                path: \"/\",\n                title: \"首页\",\n              },\n            ]}\n            preset={preset}\n            themeToken={themeToken}\n            readme={readme}\n        />\n      </HashRouter>\n  );\n};\n\nexport default App;\n","import { ajax } from \"./preset\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport App from \"./App\";\n\nconst root = ReactDOM.createRoot(document.getElementById(\"root\"));\n\nconst themeToken = {\n  colorPrimary: \"#4F185A\",\n};\n\nroot.render(\n    <React.StrictMode>\n      <App preset={{ ajax }} themeToken={themeToken} />\n    </React.StrictMode>\n);\n","import imgFail from './img_fail.svg';\n\nconst resizeBase64Image = (base64, width, height) => {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.src = base64;\n\n        img.onload = function () {\n            // 创建一个 Canvas 元素\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n\n            const wRatio = img.width / width, hRatio = img.height / height;\n            const ratio = Math.max(wRatio, hRatio, 1);\n\n            // 设置 Canvas 的宽度和高度为缩放后的尺寸\n            canvas.width = img.width / ratio;\n            canvas.height = img.height / ratio;\n\n            // 将图片绘制到 Canvas 上，并缩放\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n            // 从 Canvas 中获取缩放后的图片数据，并将其转换为 Base64 格式\n            const resizedBase64 = canvas.toDataURL('image/png'); // 可以根据需要更改图片格式\n            // 调用回调函数，返回缩放后的 Base64 图片\n            resolve(resizedBase64);\n        };\n\n        img.onerror = function (error) {\n            reject(error);\n        };\n    });\n}\n\nclass OssUploadAdapter {\n    constructor(loader, options) {\n        this.loader = loader;\n        this.options = options;\n        this.base64MaxWidth = options.base64MaxWidth || 600;\n        this.base64MaxHeight = options.base64MaxHeight || 600;\n    }\n\n    async upload() {\n        const file = await this.loader.file;\n        if (typeof this.options.upload !== 'function') {\n            console.warn('当前图片上传为base64模式，正式环境请在preset apis设置file.upload,或者给CKEditor组件传入 config.ossUpload.upload参数');\n            const data = await new Promise(resolve => {\n                const fileReader = new FileReader();\n                fileReader.onload = () => {\n                    resolve(fileReader.result);\n                };\n                fileReader.readAsDataURL(file);\n            });\n\n            return {\n                default: await resizeBase64Image(data, this.base64MaxWidth, this.base64MaxHeight)\n            };\n        }\n        const {data: resData} = await this.options.upload({file});\n        if (resData.code !== 0) {\n            this.options.message.error(resData.msg);\n            return {default: imgFail};\n        }\n        return {\n            default: resData.data\n        };\n    }\n}\n\nfunction OssUploadAdapterPlugin(editor) {\n    const message = editor.config.get('message');\n    const options = Object.assign({}, {message}, editor.config.get('ossUpload'));\n    editor.plugins.get('FileRepository').createUploadAdapter = loader => {\n        return new OssUploadAdapter(loader, options);\n    };\n    editor.editing.view.document.on('clipboardInput', (evt, data) => {\n        if (editor.isReadOnly) {\n            return;\n        }\n\n        const dataTransfer = data.dataTransfer;\n        const html = dataTransfer.getData('text/html');\n        const parser = new DOMParser();\n        const domDocument = parser.parseFromString(html, 'text/html');\n        if (domDocument.querySelectorAll('img').length === 0) {\n            return;\n        }\n        data.content = editor.data.htmlProcessor.toView('');\n        const loadingClose = message.loading('粘贴内容中含有图片，正在进行图片上传...', {duration: 0});\n        Promise.all([].slice.call(domDocument.querySelectorAll('img'), 0).map(async img => {\n            if (typeof options.uploadUrl !== 'function') {\n                console.warn('图片上传失败，请在preset apis设置file.uploadUrl,或者给CKEditor组件传入 config.ossUpload.uploadUrl参数');\n                return;\n            }\n            const {code, data, msg} = await options.uploadUrl({url: img.src});\n            if (code !== 0) {\n                console.warn(`图片上传失败，${msg}`);\n                img.src = imgFail;\n                return;\n            }\n            img.src = data;\n        }))\n            .then(() => {\n                editor.model.insertContent(editor.data.toModel(editor.data.htmlProcessor.toView(domDocument.documentElement.outerHTML)));\n            })\n            .finally(() => {\n                loadingClose();\n            });\n    });\n}\n\nexport default OssUploadAdapterPlugin;\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 5764;\nmodule.exports = webpackEmptyContext;"],"names":["window","PUBLIC_URL","process","componentsCoreRemote","remote","url","tpl","defaultVersion","remoteLoaderPreset","remotes","default","ajax","axios","validateStatus","fetchPreset","loading","_jsx","Spin","delay","style","position","left","padding","transform","error","empty","Empty","transformResponse","response","data","code","msg","results","ExampleRoutes","createEntry","_ref","preset","themeToken","props","HashRouter","children","paths","key","path","title","readme","ReactDOM","document","getElementById","render","React","App","colorPrimary","OssUploadAdapter","constructor","loader","options","this","base64MaxWidth","base64MaxHeight","upload","file","console","warn","Promise","resolve","fileReader","FileReader","onload","result","readAsDataURL","base64","width","height","reject","img","Image","src","canvas","createElement","ctx","getContext","wRatio","hRatio","ratio","Math","max","drawImage","resizedBase64","toDataURL","onerror","resizeBase64Image","resData","message","imgFail","editor","config","get","Object","assign","plugins","createUploadAdapter","editing","view","on","evt","isReadOnly","html","dataTransfer","getData","domDocument","DOMParser","parseFromString","querySelectorAll","length","content","htmlProcessor","toView","loadingClose","duration","all","slice","call","map","async","uploadUrl","then","model","insertContent","toModel","documentElement","outerHTML","finally","webpackEmptyContext","req","e","Error","keys","id","module","exports"],"sourceRoot":""}